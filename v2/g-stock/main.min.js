var element = $(this);

$(function () {
  var $mantra = $("#home-type");
  var $si = $("#scroll-icon");
  setTimeout(function () {
    $mantra.animate({ opacity: 1 }, 3e3);
  }, 100);
  var $slider = $("#slideshow");
  setTimeout(function () {
    $si.animate({ opacity: 0.9 });
    $slider.animate({ opacity: 1 }, 3e3);
  }, 2e3);
  $si.queue(function (next) {
    $(this)
      .animate({ opacity: 0.5 }, 300)
      .delay(200)
      .animate({ opacity: 0.9 }, 300);
    $(this).queue(arguments.callee);
    next();
  });
  $(".fancybox").fancybox();
});
$(function () {
 
  var $panel = $("#panel-wrap li");
  var text_pane = $("ul#panel-wrap .pane");
  var arrow = $("figure.arrow");
  var pane1 = $("ul#panel-wrap li .pane");
  var $c = $(".close-btn");
  var $tl = $(".text-layer");
  var $b1 = $("figure#brush1");
  var $ex = $(".expanded");
  $panel.addClass("init");
  $ex.addClass("expand-invisible");
  var element = $(this);
  var $i = $("figure, .close-btn");
  $panel.click(function (event) {
    event.preventDefault();
    if ($(this).is(".init"))
      $(this)
        .removeClass("init")
        .addClass("opened")
        .siblings()
        .addClass("smaller")
        .fadeTo("slow", 0.3)
        .removeClass("init")
        .end()
        .find(".text-layer")
        .addClass("p-active")
        .end()
        .delay(1300)
        .queue(function (next) {
          $(this).find(".text-layer").addClass("ivis");
          next();
        })
        .delay(300)
        .queue(function (next) {
          $(this)
            .find("div.expanded")
            .removeClass("expand-invisible")
            .addClass("expand-visible")
            .addClass("t-pos");
          next();
        })
        .delay(300)
        .queue(function (next) {
          $(this).find("article").addClass("vis");
          next();
        })
        .delay(150)
        .queue(function (next) {
          $(this).find($i).addClass("vis");
          next();
        })
        .end();
    else
      $(this)
        .siblings()
        .delay(150)
        .queue(function (next) {
          $(this).find($i).removeClass("vis");
          next();
        })
        .delay(200)
        .queue(function (next) {
          $(this).find("article").removeClass("vis");
          next();
        })
        .delay(200)
        .queue(function (next) {
          $(this)
            .find("div.expanded")
            .addClass("expand-invisible")
            .removeClass("expand-visible")
            .removeClass("t-pos");
          next();
        })
        .delay(800)
        .queue(function (next) {
          $(this).find(".text-layer").removeClass("ivis");
          next();
        })
        .end()
        .delay(800)
        .queue(function (next) {
          $(this)
            .siblings()
            .removeClass("opened")
            .addClass("smaller")
            .fadeTo(800, 0.3)
            .end()
            .removeClass("smaller")
            .addClass("opened")
            .siblings()
            .find(".text-layer")
            .removeClass("p-active")
            .end();
          next();
        })
        .fadeTo(600, 1)
        .find(".text-layer")
        .addClass("p-active")
        .end()
        .delay(800)
        .queue(function (next) {
          $(this).find(".text-layer").addClass("ivis");
          next();
        })
        .delay(300)
        .queue(function (next) {
          $(this)
            .find("div.expanded")
            .removeClass("expand-invisible")
            .addClass("expand-visible")
            .addClass("t-pos");
          next();
        })
        .delay(300)
        .queue(function (next) {
          $(this).find("article").addClass("vis");
          next();
        })
        .delay(150)
        .queue(function (next) {
          $(this).find($i).addClass("vis");
          next();
        })
        .end();
  });
  $panel.hover(
    function (event) {
      event.preventDefault();
      if (!$("div").hasClass("expand-visible"))
        $(this)
          .addClass("bg-move")
          .siblings("li")
          .stop()
          .addClass("child-fade");
      else if ($(this).siblings().hasClass("opened")) $(this).fadeTo("slow", 1);
      else return;
    },
    function () {
      $(this)
        .removeClass("bg-move")
        .siblings("li")
        .stop()
        .removeClass("child-fade");
      event.stopPropagation();
    }
  );
  $c.click(function (event) {
    event.preventDefault();
    $ex
      .find("article")
      .removeClass("vis")
      .end()
      .delay(450)
      .queue(function (next) {
        $ex.find($i).removeClass("vis");
        next();
      })
      .delay(300)
      .queue(function (next) {
        $ex
          .addClass("expand-invisible")
          .removeClass("expand-visible")
          .removeClass("t-pos");
        next();
      })
      .delay(300)
      .queue(function (next) {
        $panel
          .addClass("init")
          .fadeTo("600", 1)
          .removeClass("opened")
          .siblings()
          .removeClass("smaller")
          .removeClass("goaway")
          .addClass("init")
          .end();
        next();
      })
      .delay(800)
      .queue(function (next) {
        $tl.removeClass("ivis").removeClass("p-active");
        next();
      });
    event.stopPropagation();
    return !1;
  });
  var $iw = $("#photo-wrap > li");
  $iw.hover(
    function (event) {
      event.preventDefault();
      $(this).siblings().addClass("child-fade");
      event.stopPropagation();
    },
    function () {
      $(this).siblings().removeClass("child-fade");
    }
  );
  $("body").delegate(
    "section",
    "waypoint.reached",
    function (event, direction) {
      var $active = $(this);
      if (direction === "up") $active = $active.prev();
      if (!$active.length) $active = $active.end();
      $(".section-active").removeClass("section-active");
      $active.addClass("section-active");
      $(".link-active").removeClass("link-active");
      $("a[href=#" + $active.attr("id") + "]").addClass("link-active");
      event.stopPropagation();
    }
  );
  $("section").waypoint({ offset: "50%" });
  var scrollElement = "html, body";
  $("html, body").each(function () {
    var initScrollTop = $(this).attr("scrollTop");
    $(this).attr("scrollTop", initScrollTop + 1);
    if ($(this).attr("scrollTop") == initScrollTop + 1) {
      scrollElement = this.nodeName.toLowerCase();
      $(this).attr("scrollTop", initScrollTop);
      return !1;
    }
  });
  $("a[href^='#']").click(function (event) {
    event.preventDefault();
    var $this = $(this),
      target = this.hash,
      $target = $(target);
    $(scrollElement)
      .stop()
      .animate(
        { scrollTop: $target.offset().top },
        1800,
        "easeInOutExpo",
        function () {
          window.location.hash = target;
        }
      );
    event.stopPropagation();
  });
  var $family = $("#family");
  $("#about").bind("waypoint.reached", function (event, direction) {
    $family.delay(400).fadeTo(300, 1);
  });
});
